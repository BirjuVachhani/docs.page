---
import Color from 'color';
import context from 'src/context';

type Props = {
  fallback: string;
};

let colorLight: Color;
let colorDark: Color;
try {
  colorLight = Color(context.get().config.theme);
} catch {
  colorLight = Color(Astro.props.fallback);
}
try {
  colorDark = Color(context.get().config.themeDark || context.get().config.theme);
} catch {
  colorDark = Color(Astro.props.fallback);
}

const light = colorLight.hex().toString();
const dark = colorDark.hex().toString();
---

<style is:global>
  html[data-theme='dark'] {
    color-scheme: dark;
  }
</style>
<script define:vars={{ base, light, dark }}>
  const root = document.documentElement;
  root.style.setProperty('--theme-color', light);
  root.style.setProperty('--theme-color-dark', dark);
</script>
